{% extends "core/base.html" %}

{% block content %}
  <form method="post" class="col-md-6 offset-md-3">
    <h2 class="mb-4 text-center">Login to Quantum Bank</h2>
    {% csrf_token %}

    <div class="mb-3">
        <label for="id_username" class="form-label">Username:</label>
        <input type="text" name="username" autofocus autocapitalize="none" autocomplete="username" maxlength="150" class="form-control" required id="id_username">
    </div>

    <div class="mb-3 position-relative">
        <label for="id_password" class="form-label">Password:</label>
        <input type="password" name="password" autocomplete="current-password" class="form-control" required id="id_password">
        <span class="position-absolute top-50 end-0 translate-middle-y me-3" style="cursor: pointer;" onclick="togglePasswordVisibility('id_password', this)">
            <i class="bi bi-eye-slash-fill"></i>
        </span>
    </div>

    {% if form.errors %}
        <div class="alert alert-danger mt-3" role="alert">
            Your username and password didn't match. Please try again.
        </div>
    {% endif %}

    <div class="d-grid gap-2 mt-4">
        <button type="submit" class="btn btn-primary btn-lg">Login</button>
    </div>
    <hr class="my-4">
    <div class="text-center">
        <p><a href="{% url 'password_reset' %}" class="link-secondary">Forgot Password?</a></p>
        <p>Don't have an account? <a href="{% url 'signup' %}" class="link-primary">Sign Up</a></p>
        <p class="mt-3"><a href="{% url 'admin:index' %}" class="link-secondary">Admin Login</a></p>
    </div>
  </form>

  {% block extra_js %}
  <script>
      function togglePasswordVisibility(fieldId, iconElement) {
          const passwordField = document.getElementById(fieldId);
          const icon = iconElement.querySelector('i');
          // Toggle the type
          const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
          passwordField.setAttribute('type', type);
          // Toggle the icon
          icon.classList.toggle('bi-eye-fill');
          icon.classList.toggle('bi-eye-slash-fill');
      }
  </script>
  {% endblock %}
{% endblock %}